---
openapi: 3.0.1
info:
  title: Hommuting API
  version: v1
  description: Korean Real Estate Property Aggregation API
paths:
  "/api/v1/crawling/seoul":
    post:
      summary: 서울 매물 수집
      tags:
      - 크롤링
      description: 서울 전체 25개 구의 매물을 수집합니다. 직방 API를 통해 빌라, 원룸, 오피스텔 매물을 수집하며, 개발 모드에서는
        강남구와 서초구만 테스트로 수집합니다.
      parameters:
      - name: dev_mode
        in: query
        required: false
        description: '개발 모드 (true: 강남구, 서초구만 테스트, false: 서울 전체 25개 구)'
        example: true
        schema:
          type: boolean
      - name: property_types
        in: query
        required: false
        description: '수집할 매물 타입들 (기본값: villa, oneroom, officetel)'
        items:
          type: string
          enum:
          - villa
          - oneroom
          - officetel
          - apartment
        example:
        - villa
        - oneroom
        schema:
          type: array
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: success
                  message:
                    type: string
                    example: 서울 전체 매물 수집을 완료했습니다
                  collected_count:
                    type: integer
                    example: 1250
                  property_types:
                    type: object
                    example:
                      빌라: 500
                      원룸: 400
                      오피스텔: 350
                    description: 매물 타입별 수집 개수
                  sample_properties:
                    type: array
                    description: 수집된 매물 샘플 (최대 3개)
                    items:
                      "$ref": "#/components/schemas/Property"
                  areas_completed:
                    type: integer
                    example: 25
                    description: 완료된 지역 수
                  dev_mode:
                    type: boolean
                    example: false
                  timestamp:
                    type: string
                    format: date-time
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: error
                  message:
                    type: string
                    example: 서울 매물 수집 중 오류가 발생했습니다
                  error:
                    type: string
  "/api/v1/crawling/gyeonggi":
    post:
      summary: 경기도 매물 수집
      tags:
      - 크롤링
      description: 경기도 48개 시/구의 매물을 수집합니다. 수원시 4개 구, 성남시 3개 구, 용인시 3개 구 등 구 단위로 세분화하여
        수집하며, 개발 모드에서는 수원시 영통구와 성남시 분당구만 테스트로 수집합니다.
      parameters:
      - name: dev_mode
        in: query
        required: false
        description: '개발 모드 (true: 수원시 영통구, 성남시 분당구만 테스트, false: 경기도 전체 48개 시/구)'
        example: true
        schema:
          type: boolean
      - name: property_types
        in: query
        required: false
        description: '수집할 매물 타입들 (기본값: villa, oneroom, officetel)'
        items:
          type: string
          enum:
          - villa
          - oneroom
          - officetel
          - apartment
        example:
        - villa
        - oneroom
        schema:
          type: array
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: success
                  message:
                    type: string
                    example: 경기도 전체 매물 수집을 완료했습니다
                  collected_count:
                    type: integer
                    example: 2100
                  property_types:
                    type: object
                    example:
                      빌라: 800
                      원룸: 700
                      오피스텔: 600
                    description: 매물 타입별 수집 개수
                  sample_properties:
                    type: array
                    description: 수집된 매물 샘플 (최대 3개)
                    items:
                      "$ref": "#/components/schemas/Property"
                  areas_completed:
                    type: integer
                    example: 48
                    description: 완료된 지역 수
                  dev_mode:
                    type: boolean
                    example: false
                  timestamp:
                    type: string
                    format: date-time
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: error
                  message:
                    type: string
                    example: 경기도 매물 수집 중 오류가 발생했습니다
                  error:
                    type: string
  "/api/v1/crawling/all":
    post:
      summary: 전체 매물 수집
      tags:
      - 크롤링
      description: 서울과 경기도 전체 매물을 한 번에 수집합니다. 서울 25개 구와 경기도 48개 시/구의 모든 매물을 포함하며,
        총 73개 지역에서 매물을 수집합니다.
      parameters:
      - name: dev_mode
        in: query
        required: false
        description: '개발 모드 (true: 테스트 지역만, false: 전체 73개 지역)'
        example: true
        schema:
          type: boolean
      - name: property_types
        in: query
        required: false
        description: '수집할 매물 타입들 (기본값: villa, oneroom, officetel)'
        items:
          type: string
          enum:
          - villa
          - oneroom
          - officetel
          - apartment
        example:
        - villa
        - oneroom
        schema:
          type: array
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: success
                  message:
                    type: string
                    example: 서울 및 경기도 전체 매물 수집을 완료했습니다
                  total_collected:
                    type: integer
                    example: 3350
                  breakdown:
                    type: object
                    properties:
                      seoul:
                        type: object
                        properties:
                          count:
                            type: integer
                            example: 1250
                          areas:
                            type: integer
                            example: 25
                          property_types:
                            type: object
                            example:
                              빌라: 500
                              원룸: 400
                              오피스텔: 350
                          sample_properties:
                            type: array
                            description: 서울 매물 샘플
                            items:
                              "$ref": "#/components/schemas/Property"
                      gyeonggi:
                        type: object
                        properties:
                          count:
                            type: integer
                            example: 2100
                          areas:
                            type: integer
                            example: 48
                          property_types:
                            type: object
                            example:
                              빌라: 800
                              원룸: 700
                              오피스텔: 600
                          sample_properties:
                            type: array
                            description: 경기도 매물 샘플
                            items:
                              "$ref": "#/components/schemas/Property"
                  dev_mode:
                    type: boolean
                    example: false
                  timestamp:
                    type: string
                    format: date-time
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: error
                  message:
                    type: string
                    example: 전체 매물 수집 중 오류가 발생했습니다
                  error:
                    type: string
  "/api/v1/crawling/status":
    get:
      summary: 크롤링 현황 조회
      tags:
      - 크롤링
      description: 현재 수집된 매물 통계와 크롤링 현황을 조회합니다. 지역별, 매물 유형별, 거래 유형별 분포를 포함합니다.
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  total_properties:
                    type: integer
                    example: 1250
                  seoul_properties:
                    type: integer
                    example: 800
                  gyeonggi_properties:
                    type: integer
                    example: 450
                  by_property_type:
                    type: object
                    example:
                      apartment: 500
                      villa: 300
                      officetel: 250
                  by_deal_type:
                    type: object
                    example:
                      sale: 600
                      jeonse: 400
                      monthly_rent: 250
                  last_updated:
                    type: string
                    format: date-time
                  recent_properties:
                    type: array
                    description: 최근 수집된 매물 목록
                    items:
                      "$ref": "#/components/schemas/Property"
  "/api/v1/properties":
    get:
      summary: 매물 목록 조회
      tags:
      - 매물
      description: 매물 목록을 페이지네이션과 함께 조회합니다. 매물 유형, 거래 유형, 지역 등으로 필터링 가능합니다.
      parameters:
      - name: property_type
        in: query
        enum:
        - apartment
        - villa
        - officetel
        - single_house
        - multi_house
        - mixed_use
        description: "매물 유형 필터:\n * `apartment` \n * `villa` \n * `officetel` \n *
          `single_house` \n * `multi_house` \n * `mixed_use` \n "
        schema:
          type: string
      - name: deal_type
        in: query
        enum:
        - sale
        - jeonse
        - monthly_rent
        description: 거래 유형 필터
        schema:
          type: string
      - name: source
        in: query
        description: 매물 데이터 출처 필터
        schema:
          type: string
      - name: page
        in: query
        description: '페이지 번호 (기본: 1)'
        schema:
          type: integer
      - name: per_page
        in: query
        description: '페이지당 항목 수 (기본: 20)'
        schema:
          type: integer
      - name: lat
        in: query
        description: 중심 위도
        schema:
          type: number
      - name: lng
        in: query
        description: 중심 경도
        schema:
          type: number
      - name: radius
        in: query
        description: 반경 (km)
        schema:
          type: number
      responses:
        '200':
          description: Success
          content:
            application/json:
              examples:
                success:
                  value:
                    properties:
                    - id: 1
                      title: 강남구 논현동 빌라
                      address_text: 서울시 강남구 논현동
                      price: 1000/50
                      property_type: 빌라
                      deal_type: 월세
                      area_sqm: 25.5
                      current_floor: 2
                      total_floors: 4
                      room_structure: 원룸
                      maintenance_fee: 50000
                      address:
                        local1: 서울특별시
                        local2: 강남구
                        local3: 논현동
                        full_address: 서울특별시 강남구 논현동
                      property_image:
                        thumbnail_url: https://example.com/thumb.jpg
                        image_urls:
                        - https://example.com/img1.jpg
                    pagination:
                      current_page: 1
                      per_page: 20
                      total_count: 100
              schema:
                "$ref": "#/components/schemas/PropertyList"
  "/api/v1/properties/{id}":
    parameters:
    - name: id
      in: path
      required: true
      schema:
        type: string
    get:
      summary: 매물 상세 조회
      tags:
      - 매물
      description: 특정 매물의 상세 정보를 조회합니다.
      responses:
        '200':
          description: Success
          content:
            application/json:
              examples:
                success:
                  value:
                    id: 1
                    title: 강남구 논현동 신축 빌라
                    address_text: 서울시 강남구 논현동 123-45
                    price: 50000/80
                    property_type: 빌라
                    deal_type: 월세
                    area: 33㎡
                    floor: 3층
                    description: 깔끔한 신축 빌라입니다. 교통이 편리하고 주변 상권이 발달했습니다.
                    area_description: 33㎡
                    area_sqm: 33.0
                    floor_description: 3층
                    current_floor: 3
                    total_floors: 4
                    room_structure: 투룸
                    maintenance_fee: 80000
                    latitude: 37.5172
                    longitude: 127.0473
                    source: zigbang_api
                    address:
                      id: 1
                      local1: 서울특별시
                      local2: 강남구
                      local3: 논현동
                      local4: 123-45
                      short_address: 강남구 논현동
                      full_address: 서울특별시 강남구 논현동 123-45
                    property_image:
                      id: 1
                      thumbnail_url: https://example.com/thumb.jpg
                      image_urls:
                      - https://example.com/img1.jpg
                      - https://example.com/img2.jpg
                      - https://example.com/img3.jpg
        '404':
          description: Not Found
  "/api/v1/properties/search":
    get:
      summary: 매물 검색
      tags:
      - 매물
      description: 제목, 주소, 설명에서 키워드를 검색합니다. 추가 필터링 옵션 사용 가능합니다.
      parameters:
      - name: q
        in: query
        required: true
        description: 검색어
        schema:
          type: string
      - name: property_type
        in: query
        enum:
        - apartment
        - villa
        - officetel
        - single_house
        - multi_house
        - mixed_use
        description: "매물 유형 필터:\n * `apartment` \n * `villa` \n * `officetel` \n *
          `single_house` \n * `multi_house` \n * `mixed_use` \n "
        schema:
          type: string
      - name: deal_type
        in: query
        enum:
        - sale
        - jeonse
        - monthly_rent
        description: 거래 유형 필터
        schema:
          type: string
      - name: source
        in: query
        description: 매물 데이터 출처 필터
        schema:
          type: string
      - name: page
        in: query
        description: '페이지 번호 (기본: 1)'
        schema:
          type: integer
      - name: per_page
        in: query
        description: '페이지당 항목 수 (기본: 20)'
        schema:
          type: integer
      responses:
        '200':
          description: Success
  "/api/v1/properties/stats":
    get:
      summary: 매물 통계
      tags:
      - 매물
      description: 전체 매물 통계 정보를 제공합니다. 총 개수, 유형별 분포, 최근 등록 매물 등을 포함합니다.
      responses:
        '200':
          description: Success
  "/api/v1/properties/by_area":
    get:
      summary: 지역별 매물 조회
      tags:
      - 매물
      description: 특정 좌표 중심으로 반경 내의 매물을 조회합니다. 위도, 경도와 반경을 지정하여 해당 지역의 매물을 검색할 수 있습니다.
      parameters:
      - name: lat
        in: query
        required: true
        description: '중심 위도 (예: 37.5665)'
        schema:
          type: number
      - name: lng
        in: query
        required: true
        description: '중심 경도 (예: 126.9780)'
        schema:
          type: number
      - name: radius
        in: query
        description: '검색 반경 (기본값: 0.01, 약 1km)'
        schema:
          type: number
      - name: property_type
        in: query
        enum:
        - apartment
        - villa
        - officetel
        - single_house
        - multi_house
        - mixed_use
        description: "매물 유형 필터:\n * `apartment` \n * `villa` \n * `officetel` \n *
          `single_house` \n * `multi_house` \n * `mixed_use` \n "
        schema:
          type: string
      - name: deal_type
        in: query
        enum:
        - sale
        - jeonse
        - monthly_rent
        description: 거래 유형 필터
        schema:
          type: string
      - name: source
        in: query
        description: 매물 데이터 출처 필터
        schema:
          type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  center:
                    type: object
                    properties:
                      lat:
                        type: number
                      lng:
                        type: number
                  radius:
                    type: number
                  properties:
                    type: array
                    items:
                      "$ref": "#/components/schemas/Property"
                  count:
                    type: integer
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Latitude and longitude are required
components:
  schemas:
    Property:
      type: object
      properties:
        id:
          type: integer
        title:
          type: string
        address_text:
          type: string
          description: 기본 주소 텍스트
        price:
          type: string
        property_type:
          type: string
          enum:
          - 아파트
          - 빌라
          - 오피스텔
          - 단독주택
          - 다가구
          - 주상복합
        deal_type:
          type: string
          enum:
          - 매매
          - 전세
          - 월세
        area:
          type: string
          description: 면적 (기본 표시용)
        floor:
          type: string
          description: 층수 (기본 표시용)
        description:
          type: string
          description: 매물 설명
        area_description:
          type: string
          description: 면적 상세 설명
        area_sqm:
          type: number
          format: float
          description: 면적 (제곱미터)
        floor_description:
          type: string
          description: 층수 상세 설명
        current_floor:
          type: integer
          description: 현재 층
        total_floors:
          type: integer
          description: 전체 층수
        room_structure:
          type: string
          description: '방 구조 (예: 2룸, 3룸)'
        maintenance_fee:
          type: integer
          description: 관리비 (원)
        latitude:
          type: number
          format: float
        longitude:
          type: number
          format: float
        source:
          type: string
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
        address:
          "$ref": "#/components/schemas/Address"
        property_image:
          "$ref": "#/components/schemas/PropertyImage"
        apartment_detail:
          "$ref": "#/components/schemas/ApartmentDetail"
    Address:
      type: object
      properties:
        id:
          type: integer
        property_id:
          type: integer
        local1:
          type: string
          description: '시/도 (예: 서울특별시)'
        local2:
          type: string
          description: '구/시 (예: 강남구)'
        local3:
          type: string
          description: '동 (예: 논현동)'
        local4:
          type: string
          description: 상세 주소
        short_address:
          type: string
          description: 간단 주소 (구 + 동)
        full_address:
          type: string
          description: 전체 주소
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
    PropertyImage:
      type: object
      properties:
        id:
          type: integer
        property_id:
          type: integer
        thumbnail_url:
          type: string
          format: uri
          description: 썸네일 이미지 URL
        image_urls:
          type: array
          items:
            type: string
            format: uri
          description: 매물 이미지 URL 배열
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
    ApartmentDetail:
      type: object
      properties:
        id:
          type: integer
        property_id:
          type: integer
        area_ho_id:
          type: integer
          description: 직방 호 ID
        area_danji_id:
          type: integer
          description: 단지 ID
        area_danji_name:
          type: string
          description: 단지명
        danji_room_type_id:
          type: integer
          description: 단지 방 타입 ID
        dong:
          type: string
          description: 동 정보
        room_type_title:
          type: object
          description: 방 타입 제목 (다국어)
        size_contract_m2:
          type: number
          format: float
          description: 계약 면적 (제곱미터)
        tran_type:
          type: string
          description: 거래 유형
        item_type:
          type: string
          description: 매물 타입
        is_price_range:
          type: boolean
          description: 가격 범위 여부
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
    PropertyList:
      type: object
      properties:
        properties:
          type: array
          items:
            "$ref": "#/components/schemas/Property"
        pagination:
          "$ref": "#/components/schemas/Pagination"
    Pagination:
      type: object
      properties:
        current_page:
          type: integer
        per_page:
          type: integer
        total_count:
          type: integer
servers:
- url: http://localhost:3000
  description: Development server
- url: https://{defaultHost}
  variables:
    defaultHost:
      default: api.hommuting.com
  description: Production server
